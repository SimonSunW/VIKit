# Makefile for VIKit C executables

include files.mak

CC_FLAGS := -std=c99
LINK_VIKIT_FLAGS := -lVIKit -LVIKit

all: $(COMPILED_EXECUTABLE_FILES)
	@cp VIKit/$(VIKIT_DLL) .

%.exe : %.c
	gcc $(CC_FLAGS) $< -o $@ $(LINK_VIKIT_FLAGS)

install: $(COMPILED_EXECUTABLE_FILES) $(SETTINGS_FILES) $(EXECUTABLE_FILES) $(VIKIT_DLL) $(CALLABLE_VIPROJECT_FILES)
	@ls "$(DEST)" >/dev/null
	@cp $(COMPILED_EXECUTABLE_FILES) $(SETTINGS_FILES) $(EXECUTABLE_FILES) $(VIKIT_DLL) "$(DEST)"
	@mkdir -p "$(DEST)/$(VIPROJECT_DIR)"
	@cp $(CALLABLE_VIPROJECT_FILES) "$(DEST)/$(VIPROJECT_DIR)"
	@mkdir -p "$(DEST)/$(VISNIPPET_SUPPORT_DIR)"
	@cp $(CALLABLE_VIVENDOR_FILES) "$(DEST)/$(VIVENDOR_DIR)"
	@cp $(CALLABLE_VISNIPPET_FILES) "$(DEST)/$(VISNIPPET_DIR)"
	@cp $(CALLABLE_VISNIPPET_SUPPORT_FILES) "$(DEST)/$(VISNIPPET_SUPPORT_DIR)"

clean:
	rm -rfv *.exe
	rm -rfv *.dll
	rm -rfv *.ini
